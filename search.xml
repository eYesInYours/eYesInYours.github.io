<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>前端实习每周记</title>
    <url>/2022/11/14/%E5%89%8D%E7%AB%AF%E5%AE%9E%E4%B9%A0%E6%AF%8F%E5%91%A8%E8%AE%B0/</url>
    <content><![CDATA[<h4 id="第一周（2022-x2F-11-x2F-14-11-x2F-18）"><a href="#第一周（2022-x2F-11-x2F-14-11-x2F-18）" class="headerlink" title="第一周（2022&#x2F;11&#x2F;14 - 11&#x2F;18）"></a>第一周（2022&#x2F;11&#x2F;14 - 11&#x2F;18）</h4><h6 id="Monday"><a href="#Monday" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
加飞书、企业微信</p>
</li>
<li><p><input checked disabled type="checkbox"> 
了解类似的两个微信小程序</p>
<p><em>横向scroll-view</em></p>
<blockquote>
<p>issue：子元素宽度被压缩</p>
<p>solve：父元素设置overflow:auto，子元素设置flex-shrink:0  </p>
<br>

<p>issue：滚动条显隐show-scrollbar失效</p>
<p>solve：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">::webkit-scrollbar&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-color</span>:transparent;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>

<br>

<p>issue：分页滑动paging-enabled失效</p>
<p>solve：用swiper组件替换scroll-view组件</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
了解公司各部门业务：销售、运营、BPIT等，认识直系、旁系领导，产品概讲</p>
</li>
<li><p><input checked disabled type="checkbox"> 
与会，发懵</p>
</li>
</ul>
<h6 id="Tuesday"><a href="#Tuesday" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
页面上2&#x2F;3部分是可滑动卡片swiper，下1&#x2F;3部分为横向滑动scroll-view。</p>
<blockquote>
<p>情景：</p>
<p>当卡片切换时，scroll-view组件的子元素同样有卡片切换效果。且非最后四个子元素之前（一行展示四个子元素），表示选中的样式都添加到首个子元素上，scroll-view滑动。否则按次序往后切换选中样式。</p>
<p>点击scroll-view组件的某子项，显示对应可滑动卡片。</p>
<br>

<p>issue：暂令scroll-view一行显示5个子元素，当swiper卡片滑动到第6个子项及后，scroll-view没有发生滑动。</p>
<p>solve：</p>
<p>利用scroll-view组件的scroll-left属性，赋值：卡片的当前索引index*子项宽度。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
协助任务：做产品玩法的详解，——福袋、抽盒、一番赏等。接触各部分对接。</p>
</li>
</ul>
<h6 id="Wednesday"><a href="#Wednesday" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
对接中台部门，了解客户需求，做开发功能清单。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
协助中台，购置办公用品。</p>
</li>
</ul>
<h6 id="Thursday"><a href="#Thursday" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
对比同类型小程序，总结表格。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
采购。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
做头部活动、兴趣选择的组件。</p>
</li>
</ul>
<h6 id="Friday"><a href="#Friday" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 联系小程序源码方。</li>
</ul>
<br>

<h4 id="第二周（11-x2F-21-11-x2F-25）"><a href="#第二周（11-x2F-21-11-x2F-25）" class="headerlink" title="第二周（11&#x2F;21 - 11&#x2F;25）"></a>第二周（11&#x2F;21 - 11&#x2F;25）</h4><h6 id="Monday-1"><a href="#Monday-1" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 打杂。</li>
</ul>
<h6 id="Tuesday-1"><a href="#Tuesday-1" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 摸鱼。</li>
</ul>
<h6 id="Wednesday-1"><a href="#Wednesday-1" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 给我的任务是试一下服务器部署，了解微擎框架：可以用很多插件到微信小程序和公众号上去，比如说设置公众号的自动回复，或者发布一个转盘抽奖的插件到小程序上去，暂时了解是这样。</li>
</ul>
<h6 id="Thursday-1"><a href="#Thursday-1" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><input checked disabled type="checkbox"> 宝塔配置服务器，创建站点，同实习生帮我解决的。之前搭个人博客的域名，在这用上作用了，我给域名解析添加了条记录，后面申请SSL证书也需要添加记录。</li>
</ul>
<h6 id="Friday-1"><a href="#Friday-1" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
通过宝塔去下载微擎，有两个问题：</p>
<ol>
<li><p>需要SSL证书。</p>
</li>
<li><p>连接了shadowsockesX，但访问域名报错“500 Internal Privoxy Error”。如果不连接，下载微擎前的资质验证就会显示：无法访问外网。</p>
</li>
</ol>
</li>
<li><p><input checked disabled type="checkbox"> 
现在公司的服务器炸了，没能继续做。——更新：有云服务器了，下午准备的Linux虚拟机没用上，浅看了下，之前宝塔建站的问题是因为服务器，它推荐是在Linux环境下，当时在windows，所以再去做就会很快。后续微擎的安装还不知道。</p>
</li>
</ul>
<h6 id="总结："><a href="#总结：" class="headerlink" title="总结："></a><em>总结：</em></h6><p>这一部分的任务需要Linux基础，如果有了解，可能宝塔搭建站点时就不会稀里糊涂了。总的来说，的确是没接触过服务器部署这方面，每天焦头烂额但又没什么进展，甚至微擎都还没安装好。</p>
<p>打算周六周日把Linux学一下（非前端需要）。</p>
<p>更新：不需要Linux基础，当时需要的是Linux环境。</p>
<br>

<h4 id="第三周（11-x2F-28-12-x2F-2）"><a href="#第三周（11-x2F-28-12-x2F-2）" class="headerlink" title="第三周（11&#x2F;28 - 12&#x2F;2）"></a>第三周（11&#x2F;28 - 12&#x2F;2）</h4><h6 id="Monday-Wednesday"><a href="#Monday-Wednesday" class="headerlink" title="Monday - Wednesday"></a><em>Monday</em> - <em>Wednesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 居家隔离，总算把微擎安装好了，但是现在又需要已备案的域名。</li>
</ul>
<h6 id="Thursday-2"><a href="#Thursday-2" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><input checked disabled type="checkbox"> 了解：PC端的购物网站是通过Shopify这个平台，通过模块化添加的方式，它也会提供主题模板，快速搭建起来的。Shopify平台写的页面用的是liquid语法。</li>
</ul>
<h6 id="Friday-2"><a href="#Friday-2" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
买了一个已备案的域名，下午在云服务器上准备按照之前的流程安装微擎，结果宝塔又报错了。——可能是PHP版本过高导致的站点404 page not found，接着是nginx报错创建不了站点，最后不管是PHP还是nginx都没法更新、卸载了。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
先在Linux虚拟机上试试，这些问题要交给上周说的那个小伙伴了。</p>
</li>
</ul>
<br>

<h4 id="第四周（12-x2F-5-12-x2F-9）"><a href="#第四周（12-x2F-5-12-x2F-9）" class="headerlink" title="第四周（12&#x2F;5 - 12&#x2F;9）"></a>第四周（12&#x2F;5 - 12&#x2F;9）</h4><h6 id="Monday-2"><a href="#Monday-2" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 把阿里云域名的DNS服务器指向腾讯云，微擎正式能用了。</li>
</ul>
<h6 id="Tuesday-2"><a href="#Tuesday-2" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 假的，微擎又不能访问了。解决了服务器解析和SSL证书问题。</li>
</ul>
<h6 id="Wednesday-2"><a href="#Wednesday-2" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
重新安装微擎，这会儿是真的可以了，然后在研究它的功能。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
创建微信公众号，但是微信公众平台上主体是个人，不能微信验证，有些接口权限比如：自定义菜单、群发、支付等等很多都没有。</p>
<p>虽然还只是简单实现了自动回复，但感觉很惊奇！</p>
</li>
<li><p><input checked disabled type="checkbox"> 
主要还是得了解微信小程序这边在微擎封装了的用法，支持自己开发插件。后面可能是要在公众号的底部菜单放一个跳转到小程序的链接。</p>
</li>
</ul>
<h6 id="Thursday-3"><a href="#Thursday-3" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><input checked disabled type="checkbox"> 试用了一个微擎市场的微信小程序插件。</li>
<li><input checked disabled type="checkbox"> 用微信公众平台原生实现了公众号菜单，菜单项和小程序关联起来了。小程序审核过，大概就没问题了。</li>
</ul>
<h6 id="Friday-3"><a href="#Friday-3" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 做了个内部用的小组件：表单展示、跳转页面修改。</li>
</ul>
<br>

<h4 id="第五周（12-x2F-12-12-x2F-16）"><a href="#第五周（12-x2F-12-12-x2F-16）" class="headerlink" title="第五周（12&#x2F;12 - 12&#x2F;16）"></a>第五周（12&#x2F;12 - 12&#x2F;16）</h4><h6 id="Monday-3"><a href="#Monday-3" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
具体完善了一些组件的功能和样式：增删行的信息、登录注册，明天去看看路由拦截这一方面，比如说未登录状态想要跳转到名单内路径时，直接跳回登录注册页面。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
公司不用GitHub的原因是Github为公网，出于隐私就自己搭建了Git环境。</p>
</li>
</ul>
<h6 id="Tuesday-3"><a href="#Tuesday-3" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
做一个抽奖的页面，在想要怎么去实现中奖后那个礼盒抖动开盒、奖品展现的效果。——用popup弹出层组件，弹出一个GIF播放作开盒的效果。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
表单验证：未输入账号和密码不允许登录、输入长度限制等，用Vuex存一个变量值（Boolean）作index页提交按钮的disabled属性值，登录后在登录页将该变量赋值true（根据mobile和password都已输入，计算属性computed返回），index页按钮显示可提交，同时页面导航回index页。</p>
</li>
</ul>
<h6 id="Wednesday-3"><a href="#Wednesday-3" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
用Vue2的语法去写uniapp，在data中声明了两个Boolean类型变量，但是在methods中定义的点击事件无法修改它们。解决办法：定义两个computed分别引用这两个变量，再用完整写法都添加一个set、一个get。set将传入值赋给变量，get返回变量。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
表单验证：账号方面做了手机号码的正则校验。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
数据回显问题：</p>
<blockquote>
<p>scene：</p>
<p>在my-table表格组件中，点击某一行则将该行数据对象存入Vuex，然后跳转到详情页（分页），详情页将其获得并渲染。当修改某一条数据不想提交而返回上页，再次进入详情页的数据不应该是修改过的。</p>
<br>

<p>solve：</p>
<p>就是把传入Vuex中的某行数据对象，通过深拷贝独立于原本的数据对象。</p>
<p>浅拷贝和直接将数据对象传入Vuex，这样做在详情页获取并修改时，将原本的数据对象也更改了，那么下次再次点击表格某行进入详情页，依旧是上次的数据。</p>
</blockquote>
</li>
<li><p><input disabled type="checkbox"> 
页面中用computed缓存了一个Vuex数据对象，绑定在一个表单上。其中每个input或select都通过v-model与该数据对象某属性形成双向绑定，但问题在于Vuex中的state数据只能通过mutations方法去修改，input或select可以读，但写就会出现问题。</p>
<blockquote>
<p>另外定义计算属性变量，set调用Vuex的mutations方法去修改该对象某属性的数据，get返回数据。这种方法也行，但是太繁琐了，好多computed和mutation的定义。</p>
<br>

<p>好奇怪，我在Vuex的state存了个变量，试验不通过mutations的方法直接去修改，果然报错了。但是！！奇怪的是直接用v-model绑定数据字段，居然是可行、不报错的。</p>
</blockquote>
</li>
</ul>
<h6 id="Thursday-4"><a href="#Thursday-4" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
搜索框、登录组件的v-if判断，以前做过所以直接复用。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
用Vuex更新数据然后导航回页面时（登录后返回页面），会报一个错：</p>
<blockquote>
<p>Expected updated data but get first rendering data</p>
</blockquote>
<p>解决思路就是想怎么在数据更新后，让页面重新渲染。然后就用到了reLaunch这个方法，关闭所有页面，跳转到某个页面。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
给组件绑定click事件失效，加个修饰符native就行。另一种麻烦的方法是，在组件内部用emit触发给组件标签绑定的事件。</p>
</li>
</ul>
<h6 id="Friday-4"><a href="#Friday-4" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
调用getWindowInfo方法，得到设备的可用高度windowHeight，然后按占据的比例乘个几分之几，做各个区域view的高度。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
tab切换，展示不同的内容。小程序没有document语法了，要选中元素设置display:block和display:none比较麻烦，还是用Vue的v-if和v-show做切换。点击不同的tab，同时将data中变量scene改变：0、1、2，对应不同展示的内容。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
uni-drawer抽屉组件只能左右滑出，改了一下源码，从底部滑出。原本想用createAnimation方法将一个view以类似底部滑出的效果展现出来，但是这个view占据了一部分空间，导致页面可以整体上翻、下滑。</p>
</li>
</ul>
<br>

<h4 id="第六周（12-x2F-19-12-x2F-23）"><a href="#第六周（12-x2F-19-12-x2F-23）" class="headerlink" title="第六周（12&#x2F;19 - 12&#x2F;23）"></a>第六周（12&#x2F;19 - 12&#x2F;23）</h4><h6 id="Monday-4"><a href="#Monday-4" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
利用swiper原生内置组件，做中奖信息向上轮播的功能。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
100px.net上有转盘、老虎机等抽奖模块的用法，在uniapp上配置和实现。</p>
</li>
</ul>
<h6 id="Tuesday-4"><a href="#Tuesday-4" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
uniapp开发的微信小程序，它的代码是压缩的，比如说一些变量名缩减成一个字符、方法名变成数字，逻辑性降低了。可以通过反编译（b站有教程），把微信小程序（原生）的代码反编译为uniapp的语法。但是，uniapp开发的微信小程序不能再反编译回uniapp语法！</p>
</li>
<li><p><input checked disabled type="checkbox"> 
所以我现在在自己改代码，页面倒是能改回去，只是Js的逻辑代码和一些数据规范不是很好懂。而且这个微信小程序是很多模块的，模块和模块的交互，肯定不是我现在这样简单。总的来说，现在就是繁琐，没有操作性。</p>
</li>
</ul>
<h6 id="Wednesday-Friday"><a href="#Wednesday-Friday" class="headerlink" title="Wednesday - Friday"></a><em>Wednesday</em> - <em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 发烧居家。</li>
</ul>
<br>

<h4 id="第七周（12-x2F-26-12-x2F-30）"><a href="#第七周（12-x2F-26-12-x2F-30）" class="headerlink" title="第七周（12&#x2F;26 - 12&#x2F;30）"></a>第七周（12&#x2F;26 - 12&#x2F;30）</h4><h6 id="Monday-5"><a href="#Monday-5" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
把之前做的登录组件拿过来用，根据token有无显示不同的组件。抽奖模块和登录结合起来，用户登录后可以记录奖品。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
对于抽奖过程的popup组件播放gif，设置isMaskClick为false，禁止用户操作。gif背景透明且播放一次，用定时器setTimeout在2s后（gif播放时间）弹出中奖信息。</p>
</li>
</ul>
<h6 id="Tuesday-5"><a href="#Tuesday-5" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
开始从后端验证抽奖模块的功能，比如中奖的数字由后端计算返回，不放在前端（爬虫很容易拿到并篡改）。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
反编译了“盒柜”和“我的”页面一部分。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
向后端提两个接口的需要，一个修改，一个查看。字段product定义为数组，元素是对象。用户登录后可以拿到用户id，然后用这个id去向查看接口发请求，拿到这个用户的已有的商品列表。同样，拿id去向修改接口发请求，修改用户的商品数据（中奖时添加）。</p>
</li>
</ul>
<h6 id="Wednesday-4"><a href="#Wednesday-4" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
把小程序的页面全都反编译出来了，js的逻辑还没去写。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
抽奖模块要和登录联合起来，vuex中store的token从storage中读取，登录时也存到storage中去，也就是说登录一次，一段时间内不用重复登录。有点小问题是，同页面内，用mapState去读store中的token，登录页面（v-if）和已有商品列表（v-else）总是显示登录页面，就是说token没有正常读取。</p>
<p>它在登录后，页面还是能根据token来切换组件的，但在这之前，即使localStorage中有token的值也没有正常显示对应的组件。</p>
<blockquote>
<p>果然，mapState出来的token，在页面首次加载时打印为undefined，登录后则有值。</p>
<br>

<p>solve:</p>
<p>在页面的data中也添加一个token字段，值从storage中读取getStorageSync(‘token’)。</p>
<p>本来mapState的token就可以正常切换组件的（即使首次加载），我之前也是这个做法，当时是没有问题的。</p>
</blockquote>
</li>
</ul>
<h6 id="Thursday-5"><a href="#Thursday-5" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
vuex mutations中定义的方法，携带第一个参数为state，访问为undefined。原因是state定义的形式为箭头函数，改成括号形式就可以了。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
下载的一个添加收获地址的组件里，input双向绑定用的是:value，但子传父打印的数据里都是空串，显然没有双向绑定成功，改用v-model。</p>
<blockquote>
<p>:value是v-bind:value的简写方式，这是单向数据绑定。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
从页面A跳转到页面B，有一个参数需要在页面B用到，之前都是用vuex去设置。可以用另一种简单的方法，从页面A跳转到页面B时，在路径后携带参数，页面B中可以在生命周期onLoad(e)中接收到该参数。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
上一条的具体情景是：</p>
<blockquote>
<p>收货地址可以新增，也可以点击某一项进行修改。对后者，我们用到了路径携带过来的index参数，表示当前点击的收货地址数据的索引，进行数据渲染（点击不同项，显示不同的收货地址信息），当我们修改并确定保存，就将收获地址的数据字段userAddress中的第index项，修改为表单重新修改的对象。</p>
<br>

<p><em>issue:</em></p>
<p>问题就是直接修改数组对象，即使数据的确改变了，但页面不会渲染。</p>
<br>

<p><em>solve:</em></p>
<p>方法一：vuex是分模块做的，就在对应的js文件中引入Vue，调用方法</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Vue.set(targetArray, index, obj)</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">set</span>(state.<span class="property">userAddress</span>, state.<span class="property">updateIndex</span>, userAddress)</span><br></pre></td></tr></table></figure>

<p>方法二：深拷贝</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">state.<span class="property">userAddress</span>[state.<span class="property">updateIndex</span>] = userAddress</span><br><span class="line">state.<span class="property">userAddress</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(state.<span class="property">userAddress</span>))</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h6 id="Friday-5"><a href="#Friday-5" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
向后端写了个文档：需要收货地址的查询、设置接口；订单的创建（返回订单号）、预付订单（返回订单信息，用于微信支付requestPayment）、查询订单（参数：订单号，是否成功支付）的接口。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
微信公众平台可以申请几个接口的权限，比如获取用户收货地址chooseAddress、地图选择位置接口chooseLocation等，需要在manifest.json的源码中设置（uniapp）。否则是调用不成功的。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
chooseLocation唤起选择地址的界面（相当于嘀嘀打车快速定位）后，对地址数据处理，然后填充进收货地址的省区和详细地址input。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
这个收货地址的新增和修改是共用一个组件的，我在组件里定义了一个props，修改的话就会传一个数据对象给组件，然后把这个数据对象赋值给组件内部data的一个字段userAddress。</p>
<p>现在的情景是如果我是新增收货地址，那么上一条所做的chooseLocation选择地址、填充input，此时失效。我一直以为是HBuilderX的问题时好时坏，最后发现是传入的props数据字段的赋值没有做条件限制。如果没有传入props，就会把空对象赋给本地，后面就找不到对象底下的数据字段。</p>
<p>就是说，修改会传props给组件，新增不会。这里就要在组件里去判断对象（组件定义的那个prop）是否为空对象（default为{}），不是（表示有传入的数据）再做赋值给本地的操作。</p>
<p>回去复习了一下判断是否为空对象的两个方法：</p>
<blockquote>
<p><em>方法一：</em></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">item</span>) !== <span class="string">&#x27;&#123;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><em>方法二</em></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">item</span>).<span class="property">length</span> !== <span class="number">0</span></span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<br>

<h4 id="第八周（2023-x2F-1-x2F-3-1-x2F-6）"><a href="#第八周（2023-x2F-1-x2F-3-1-x2F-6）" class="headerlink" title="第八周（2023&#x2F;1&#x2F;3 - 1&#x2F;6）"></a>第八周（2023&#x2F;1&#x2F;3 - 1&#x2F;6）</h4><h6 id="Monday-6"><a href="#Monday-6" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 休假。</li>
</ul>
<h6 id="Tuesday-6"><a href="#Tuesday-6" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
通过一个接口请求回来的数据列表，首先存到本地storage里，读取的速度快很多。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
token失效，页面登出</p>
<blockquote>
<p>通过登录接口拿到expire字段，存到vuex，然后在vuex存入token的方法的末尾加上一个定时器setTimeout（只执行一次），清除token（vuex和storage），时间为之前存入的expire字段。</p>
<p>让后端暂时把expire改成15000（15s），情况是token数据是清除掉了，但是页面没有刷新为登出状态。重新编译才有效果。</p>
<p>vuex数据刷新了，但组件本地的数据没有更新。</p>
<p>之前遇到这种不能刷新的问题，用relaunch（关闭所有页面，进入某页面）或者redirectTo（重定向）就相当于刷新了页面（数据就和vuex保持一致了），但是现在当前页不能跳转到当前页。本来的想法是在当前页同样开启一个一次性定时器setTimeout，时间为通过mapState传递过来的expire过期时间，重新跳转到当前页。</p>
<br>

<p>嘿！又可以重定向到当前页了！！</p>
<p>真的好离谱，我试验了下：在定时器里写的重定向就是不可行，非得要我在定时器函数外写的uni.redirectTo，复制进定时器函数内才有效果！这是HbuilderX的问题吧！！</p>
<p>又试验了下：在定时器里写的，有时有用有时失效。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
上周有一个问题是mapState出来的数据初次渲染无效，不得不在本地data中读取了storage的数据（同数据）。现在报错了，把data数据去掉报错消失。（大概两小时后）又要给data数据加上才行…</p>
<p>不用mapState了，直接在本地data中用getStorage()读取vuex存储到本地的数据。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
在vuex的address模块中，getters返回一个选择为默认的地址，通过filter方法（它是返回符合条件的元素）。</p>
</li>
</ul>
<p>总结：之前用vscode写后台管理，报错了，一定是我的语法问题。现在用HBuilderX写uniapp，我真的总会怀疑是软件的问题，某些程序时可行、时不可行！某些逻辑可通的（我确信）理论，居然不被支持！</p>
<p>或者是uniapp的语法问题，我刷了几篇论坛，似乎是它的坑比较多。</p>
<h6 id="Wednesday-5"><a href="#Wednesday-5" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
简单做出了一个抽奖联合登录、发货、订单（暂无）、商品详情的模块，只是功能，完全没有UI。ld让前后端写个文档具体描述：到完整上线要多少人天。不包括测试，前端的优化、设计和编写暂时是10天&#x2F;人。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
之前反编译出来的uniapp程序，其中的组件可以复用出来。优化已中奖商品列表，样式问题：</p>
<blockquote>
<p>一个顶部导航条（组件）的切换，底下是另一个区域。这个区域用margin-top和导航条隔离开，但总是导致margin-top的值变成导航条的高度，两个区域紧连接在一起.</p>
<br>

<p>用绝对定位absolute解决，不再占有原来空间。（相对定位relative原有空间还是存在的，所以不起效）。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
优化收货地址列表及详情页的样式。黑白灰搭配一丢丢许嵩妹妹说很有韵味的淡紫，好看的嘞！</p>
</li>
<li><p><input checked disabled type="checkbox"> 
收货地址的两种情况（修改和添加），对于修改，switch组件设为默认（true）的同时用forEach在vuex里把所有的地址的isDefault设为false，之前没有考虑到添加，导致添加设置的默认在收货地址列表上会和已有默认造成重复。提交时再执行一遍vuex中forEach的那个方法就行。</p>
<p>另外，这时不填写任何地址信息也是可以提交的，地址列表就会显示一个空白的子项，应该禁止：条件判断对象每项元素boolean值，短路或||连接，进入判断return一条showToast。</p>
<p>删除也好做，根据列表的index值，删除（splice）vuex中state的地址信息数组对应索引的对象元素。</p>
</li>
</ul>
<h6 id="Thursday-6"><a href="#Thursday-6" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
反编译JS第一步，读懂data里参数的含义。抽奖页面的逻辑展示是通过不同参数的v-if和v-else来判断，有一块支付区域的展示比较复杂，用到了三层if、else对，又要考虑特殊情况（就是用到额外的参数做条件），理清楚关系和做参数文档（格式、作用注释）——14个参数param，90行，花了我两三小时。因为到时后端要去做这些参数，肯定要考虑到前端是怎么做呈现的，参数的逻辑他来做就要我说清楚。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
参数里有个变量是$root会报一个toJSON未定义但在渲染时使用的错，改成root。然后简单完善了这个抽奖页面的点击商品弹出详情popup、弹出支付popup、页面跳转的方法。</p>
</li>
</ul>
<h6 id="Friday-6"><a href="#Friday-6" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
根据参数显示界面，完善方法methods——耐心还是能看懂的。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
做参数字段文档。</p>
</li>
</ul>
<br>

<h4 id="第九周（1-x2F-9-1-x2F-13）"><a href="#第九周（1-x2F-9-1-x2F-13）" class="headerlink" title="第九周（1&#x2F;9 - 1&#x2F;13）"></a>第九周（1&#x2F;9 - 1&#x2F;13）</h4><h6 id="Monday-7"><a href="#Monday-7" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
上周用一个轮播图组件的同时，底下有一块卡片区域，用于显示对应轮播图奖品的概率、品牌、价格。卡片左右分别是前进、后退按钮，可以切换轮播的奖品图。</p>
<blockquote>
<p>轮播图组件图片切换时，会更新组件的当前索引current字段，点击切换我们只要对这个字段进行加、减、小于0则赋值为图片个数减1（末尾同理）。</p>
<p>当然要做节流处理，不然一个图片正在轮播时又点击切换，就会有切换效果的异常。</p>
<p>思想就是设置一个标识moving，初始false。在点击切换（methods）时首先判断如果为true，return出去、不进入函数，然后再把moving设置为true。最后要在程序处理完后把标识重新设置为false，表示轮播结束，可再次切换。</p>
<p>uniapp的原生组件swiper中有个动画结束方法animationfinish，此时把标识moving设置为false，符合思想并且实现了效果。之所以不在点击切换的method末尾设置为false，是这时即便设置了，图片轮播时标识已经为false（执行完切换的method再去轮播）。</p>
</blockquote>
</li>
</ul>
<h6 id="Tuesday-7"><a href="#Tuesday-7" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 写页面，没有设计稿。</li>
</ul>
<h6 id="Wednesday-6"><a href="#Wednesday-6" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
写uniapp还是要用响应式rpx（2rpx等于1px）为单位去适配不同的机型。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
有一块区域设置了高度690rpx，A机型能全部显示出来，B机型最大显示高度650rpx。因此造成的布局样式错乱，把高度改成650rpx（兼容最小标准）。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
有时改一个样式，其他很多地方也要跟着一起改。用less预编译定义样式变量，要有这个习惯，之前真的好麻烦。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
写页面不会有太难的地方，就一点点耗时间。但就是昨天说的没有设计稿，大部分时间要用在设计上，要从产品的理念和客户视角出发。——其实就是借鉴其他的APP。</p>
</li>
</ul>
<h6 id="Thursday-7"><a href="#Thursday-7" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
不要给block标签添加样式，block不会渲染在结构上，如果用less的语法在block的class基础上往下写，不会有效。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
uniapp的drawer组件只能左右滑，上次修改了下可以底部滑出，但宽高只能指定。</p>
<blockquote>
<p>目的是：更换机型后都能做到drawer的宽度100%横屏、高度1&#x2F;2全屏。</p>
<p>情况：用getWindowInfo获取设备的宽高后，用数据绑定将这个宽或高的字段（本地data默认为0），通过prop传入drawer组件，但在组件内这个值总为0。非动态绑定的数据字段比如一个数字，组件能正常获取。</p>
<br>

<p>也就是说动态绑定时，组件内部获取的是prop传入数据字段的默认值0，修改默认值查验得知。但在组件外的mounted钩子中，本地字段的宽高数据赋值，通过验证是没有问题的。</p>
<p>可能：prop传入组件的时间在页面mounted钩子之前。</p>
<p>结果：官方文档说width字段不支持动态绑定。</p>
<br>

<p>页面mounted的逻辑放在计算属性computed里进行，return一个宽度，这样通过动态绑定给组件内部传值时，就相当于传入一个静态的值。</p>
</blockquote>
</li>
</ul>
<h6 id="Friday-7"><a href="#Friday-7" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
封装组件时（写页面同理），样式不写在组件的style内，而是单独写一个css文件，再在组件内引入。直到刚才要写一个重复的样式，我就明白这样的好处了。（看的github项目）</p>
</li>
<li><p><input checked disabled type="checkbox"> 
好玩的reduce：</p>
<blockquote>
<p>购物车的结算金额是根据商品的勾选状态checked来计算的，首先筛选出勾选状态为true的商品数组，然后映射出其中每个对象的价格price，即此时数组的每个元素是符合条件的价格price。</p>
<p>reduce方法：</p>
<p>第一个参数为回调函数，——它的头两个参数为总数值（或前一次回调函数返回的数值）prev，和遍历数组的当前值current。</p>
<p>第二个参数为回调函数中prev的初始值，默认0。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">cartList</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">checked</span>)</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">price</span>)</span><br><span class="line">    .<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev, current</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> prev + current</span><br><span class="line">    &#125;,<span class="number">0</span>)</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h4 id="第十周（1-x2F-16-1-x2F-20）"><a href="#第十周（1-x2F-16-1-x2F-20）" class="headerlink" title="第十周（1&#x2F;16 - 1&#x2F;20）"></a>第十周（1&#x2F;16 - 1&#x2F;20）</h4><h6 id="Monday-8"><a href="#Monday-8" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
写页面：&lt;商品详情&gt;、&lt;款式选择drawer&gt;、&lt;支付详情&gt;、&lt;支付方式drawer：支付宝和微信&gt;、&lt;购物车&gt;。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
封装组件，比如购物车的商品卡片也可在商品详情页、支付详情页使用，通过props传入的条件做不同的展示。</p>
</li>
</ul>
<h6 id="Tuesday-8"><a href="#Tuesday-8" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 写页面：&lt;个人中心&gt;。收货地址和登录注册写过，复用就行，但是登录注册模块的样式要优化。</li>
</ul>
<h6 id="Wednesday-7"><a href="#Wednesday-7" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
支付详情页会展示选择的地址，在store的address模块中，用getter返回已设置默认（isDefault:true）的那项对象，渲染就行。根据这个选择的地址对象的长度展示，有时true展示地址详情，无时false展示请添加地址。</p>
<blockquote>
<p>有个样式小问题是：</p>
<p>本意是通过动态绑定class，条件判断为上面说的选择对象length。可以有瑕疵的实现，即&lt;有时地址详情&gt;会继承&lt;无时请添加地址&gt;的样式，重新编译后才恢复正常。</p>
<p>最终给&lt;请添加地址&gt;本身标签添加了class，margin:0 auto水平居中。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
uni-swipe-action的滑动删除一项时，其余项都会自动关闭，autoClose默认为true。莫名奇妙不能自动关闭，搞了好一会，看起来没问题且不明所以的bug吧。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
称&lt;商品详情页&gt;为<strong>A</strong>。<strong>A</strong>其中展示品牌、价格等信息的区域通过组件<card-description>的props条件渲染出来，该组件称为<strong>B</strong>，&lt;购物车页&gt;称为<strong>C</strong>。</card-description></p>
<blockquote>
<p><em>思路</em>：</p>
<p>当在商城点击一个商品时，跳转到<strong>A</strong>并携带上商品ID，这个ID再传递给子组件<strong>B</strong>作请求数据的参数，此后<strong>B</strong>把请求回来的数据（brand、price、inventory等）通过子传父emit传递回<strong>A</strong>，在<strong>A</strong>中的&lt;加入购物车&gt;按钮中就可以通过Vuex将这个数据对象push进入<strong>C</strong>需要渲染的商品字段。</p>
<p><em>解释</em>：</p>
<p>可以不用封装<strong>B</strong>组件，直接写在<strong>A</strong>中，这个流程就可以简化。</p>
</blockquote>
</li>
</ul>
<h6 id="Thursday-8"><a href="#Thursday-8" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
在看Github小程序项目，之前提过一次的token失效、页面登出，不是我那个做法。而是：用axios创建的实例的请求拦截器中，请求头的Authorization字段设置为存储到本地的token，即每次请求前都会首先在后端校验token，token失效返回错误promise，未失效正常返回数据。</p>
<blockquote>
<p>后端的失效处理可能和前端的一种处理方式类似：前端在首次获得token时会打一个当前初始的时间戳，此后每次请求都会用此刻的时间戳，减去初始时间戳，两者之差和过期事件expires比较。</p>
</blockquote>
</li>
</ul>
<h4 id="第十一周（1-x2F-30-2-x2F-3）"><a href="#第十一周（1-x2F-30-2-x2F-3）" class="headerlink" title="第十一周（1&#x2F;30 - 2&#x2F;3）"></a>第十一周（1&#x2F;30 - 2&#x2F;3）</h4><h6 id="Monday-9"><a href="#Monday-9" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
购物车的商品每一个都勾选时，总的全选按钮也同时勾选。</p>
<blockquote>
<p> 方法一：</p>
<p>返回&lt;购物车商品总个数&gt;和&lt;购物车商品checked为true的个数&gt;两者全等的布尔值。</p>
<p>方法二：</p>
<p>数组every()方法，元素全返回true时，整体返回true。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> state.<span class="property">cartGoods</span>.<span class="title function_">every</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">checked</span>)</span><br></pre></td></tr></table></figure>

<p>   但把购物车清空时，全选radio还是为勾选。因为此时cartGoods是个空数组，every()对空数组检测直接返回true。另外加个判断，cartGoods长度为0时直接返回false。</p>
</blockquote>
</li>
</ul>
<h6 id="Tuesday-9"><a href="#Tuesday-9" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 看了下微信开发文档的&lt;云托管&gt;和&lt;云开发&gt;，尝试了解怎么做微信支付。</li>
<li><input checked disabled type="checkbox"> 写页面。</li>
</ul>
<h6 id="Wednesday-8"><a href="#Wednesday-8" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
了解了下uniapp文档里的云开发uniCloud，有手机号一键登录（APP）、发送短信等模块。之前创建小程序时一直默认uniapp框架，其实还有uni-starter和uni-admin框架，前者uni-starter提供了已经封装好比如登录注册、修改密码、路由拦截等功能，后者uni-admin则是提供了用户管理、权限管理等模块的管理端。</p>
<p>两者可以分别创建，接入到uniCloud的同一个云空间，达到联合效果，比如滴滴打车的用户端和司机端，或者是电商小程序的用户端和商家端（To C, To B）。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
原本微信支付只要通过requestPayment向服务器的接口发请求就可以的，但现在没有接口，尝试用uniCloud下的uniPay，相当于封装好的后端服务，开箱即用。</p>
</li>
</ul>
<h6 id="Thursday-9"><a href="#Thursday-9" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
小红书首页是瀑布流布局，也是从Pinterest借鉴来的，B站Up&lt;CodingStartup起码课&gt;讲了两种实现方式。</p>
<p>uCloud插件市场有瀑布流插件<waterfall>，其中一个js文件用promise返回假数据，使用组件的地方通过该文件export的方法获得数据，虽然也是mock data但模拟了请求。接着就可以做触底加载的逻辑。</waterfall></p>
</li>
</ul>
<h6 id="Friday-8"><a href="#Friday-8" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 修改了两种登录方式的页面，一是手机号密码登录，二是验证码登录，后者要服务器开通一个短信服务。</li>
</ul>
<h4 id="第十二周（2-x2F-6-2-x2F-10）"><a href="#第十二周（2-x2F-6-2-x2F-10）" class="headerlink" title="第十二周（2&#x2F;6 - 2&#x2F;10）"></a>第十二周（2&#x2F;6 - 2&#x2F;10）</h4><h6 id="Monday-10"><a href="#Monday-10" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
页面跳转navigateTo也可携带对象参数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 携带时</span></span><br><span class="line"><span class="string">&quot;路径?paynow=&quot;</span>+<span class="built_in">encodeURIComponent</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">childData</span>))</span><br><span class="line"><span class="comment">// 接收时（parse不能转换undefined，先判断是否为undefined）</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="built_in">decodeURIComponent</span>(options.<span class="property">paynow</span>))  </span><br></pre></td></tr></table></figure>

<p>encodeURIComponent编码，decodeURIComponent解码。</p>
<p>不编码也能传递接收（就携带一个参数），之所以编码：</p>
<ol>
<li>参数<code>username=&quot;hello&amp;world=1&quot;</code>，不编码参数可能会被识别为：<code>username=hello&amp;world=1</code>，一个参数变两个。</li>
<li>把字符比如空格、中文转成浏览器能识别的。</li>
<li>数据隐私和size过大。</li>
</ol>
</li>
<li><p><input checked disabled type="checkbox"> 
&lt;结算页面&gt;的商品列表有两种情况：</p>
<ol>
<li><p>&lt;购物车&gt;已勾选的商品</p>
</li>
<li><p>&lt;商品详情页&gt;立即购买、当前商品</p>
<p>加个条件，如果是通过&lt;商品详情&gt;立即购买进入的&lt;结算页面&gt;，就用当前商品渲染。</p>
<p>否则会出现：立即购买时如果购物车中已勾选，就会直接渲染购物车的数据。</p>
</li>
</ol>
</li>
<li><p><input checked disabled type="checkbox"> 
和产品对接了一下第一阶段小程序要出的功能模块，他的原型图还在画。</p>
</li>
</ul>
<h6 id="Tuesday-10"><a href="#Tuesday-10" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
根据功能清单做前端的修改。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
搜索框下的历史记录，点删除图标就把记录全部删除。</p>
<ul>
<li><p>简单的就是将渲染记录的数组等于[ ]，但新建数组[ ]浪费了原本数组占有的空间（产生垃圾）。</p>
</li>
<li><p>将数组的长度置0也能清空，只是此时的全部删除效果要重新编译才可见。重新编译之前：存在本地的数组已清空，但AppData里还保留着数据。（不明白）</p>
</li>
<li><p>&#96;&#96;&#96;javascript<br>splice(0, this.historyList.length)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">###### *Wednesday*</span><br><span class="line"></span><br><span class="line">- [x] 以为&lt;回到顶部&gt;要自己写，原来小程序有`pageScrollTo()`这个方法可以调用。</span><br><span class="line"></span><br><span class="line">- [x] 自定义导航栏</span><br><span class="line"></span><br><span class="line">  ![image-20230208173126916](C:\Users\16236\AppData\Roaming\Typora\typora-user-images\image-20230208173126916.png)</span><br><span class="line"></span><br><span class="line">  &gt; &lt;uni-nav-bar&gt;组件支持我们自定义导航栏，比如左侧的&lt;返回&gt;和&lt;回首页&gt;图标，右侧是小程序自带去不掉的胶囊。</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 组件提供了左、中、右三个插槽，可以填入任意内容：比如Logo、搜索input。</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 如图是两个区域（上下）：&lt;手机自带的状态栏&gt;，和&lt;小程序导航栏&gt;。</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; 目的是让左侧自制的胶囊和小程序自带的胶囊做到匀称，有一个不同机型的适配：</span><br><span class="line">  &gt;</span><br><span class="line">  &gt; ```javascript</span><br><span class="line">  &gt; // 获得手机状态栏的高度</span><br><span class="line">  &gt; const that = this</span><br><span class="line">  &gt; uni.getSystemInfo(&#123;</span><br><span class="line">  &gt;     success(res) &#123;</span><br><span class="line">  &gt;         that.statusBarHeight = res.statusBarHeight</span><br><span class="line">  &gt;     &#125;</span><br><span class="line">  &gt; &#125;)</span><br><span class="line">  &gt; </span><br><span class="line">  &gt; // 获取右侧原生胶囊的位置信息：相对于屏幕左上角</span><br><span class="line">  &gt; const &#123; width, height, top, right &#125; = wx.getMenuButtonBoundingClientRect()</span><br><span class="line">  &gt; const aboveHalf = top - this.statusBarHeight	// 小程序导航栏中，胶囊上半部分的高度</span><br><span class="line">  &gt; // 设置自定义导航的高度</span><br><span class="line">  &gt; this.myBarHeight = height + 2*aboveHalf</span><br><span class="line">  &gt; </span><br><span class="line">  &gt; // 设置左侧自制的胶囊的上、左margin：保持和右侧胶囊的对称</span><br><span class="line">  &gt; this.capsuleTop = aboveHalf</span><br><span class="line">  &gt; this.capsuleLeft = uni.getWindowInfo().screenWidth - right</span><br></pre></td></tr></table></figure>
<blockquote>
<p><uni-nav-bar>把statusBar设为true，就是包含&lt;手机状态栏&gt;的高度，不用计算了。</uni-nav-bar></p>
<p>接着动态绑定，在标签里分别设置<uni-nav-bar>的高度myBarHeight、自制胶囊的margin-left、margin-top。</uni-nav-bar></p>
</blockquote>
</li>
</ul>
</li>
<li><p><input checked disabled type="checkbox"> 
解决了<uni-nav-bar>设置fixed不能固定置顶的bug，修改源码对应的fixed样式。</uni-nav-bar></p>
</li>
<li><p><input checked disabled type="checkbox"> 
原来<uni-nav-bar>左侧插槽原本就能和右侧胶囊对称，哎！</uni-nav-bar></p>
</li>
</ul>
<h6 id="Thursday-10"><a href="#Thursday-10" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
申请微信公众号（服务号）和认证企业主体，之后认证资质可以快速复用到小程序上，都已认证好了。接着微信商户号也可以继续申请（微信支付需要）。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
企业的小程序账号可以接入物流（查看物流信息）等，要我们自己的开发者服务器（后端）部署，前端再去拿后端获取的数据。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
客服</p>
<blockquote>
<p>页面用button组件，直接跳到原生的微信对话框。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;contact&quot;</span> @<span class="attr">contact</span>=<span class="string">&quot;getMessage&quot;</span>&gt;</span>联系客服<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后在对应的小程序账号appid的微信公众平台添加客服人员，有小程序和PC端可以处理用户消息。</p>
</blockquote>
</li>
</ul>
<h6 id="Friday-9"><a href="#Friday-9" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 微信小程序没法直接唤起支付宝。</li>
</ul>
<p>开会，主持人投屏，大家都聚焦着。</p>
<p>右下角弹出了Steam（游戏平台）好友游戏的消息——</p>
<h4 id="第十三周（2-x2F-13-2-x2F-17）"><a href="#第十三周（2-x2F-13-2-x2F-17）" class="headerlink" title="第十三周（2&#x2F;13 - 2&#x2F;17）"></a>第十三周（2&#x2F;13 - 2&#x2F;17）</h4><h6 id="Monday-11"><a href="#Monday-11" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 小程序第一版前端过了评审。</li>
</ul>
<h6 id="Tuesday-11"><a href="#Tuesday-11" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
罗列商城用户交互路径、页面资源引用、后端所需接口的树结构。</p>
</li>
<li><p><input checked disabled type="checkbox"> </p>
<ol>
<li>前端获取手机号的API，getPhoneNumber获取动态令牌code，把这个code传给后端（后端也是调一个官方接口，不允许小程序前端调用），后端携带参数code和access_token获取手机号，返回前端。</li>
<li>登录也是，前端获取code，后端携带code、appid等参数请求官方接口，请求到&lt;自定义登录态&gt;等，并返回前端。之后前端的每次业务请求携带&lt;自定义登录态&gt;，后端通过校验才返回数据。</li>
</ol>
</li>
</ul>
<h6 id="Wednesday-9"><a href="#Wednesday-9" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 解决shopify网站的排版问题。</li>
<li><input checked disabled type="checkbox"> 拆分任务，明天有前端的新同学来。</li>
</ul>
<h6 id="Thursday-11"><a href="#Thursday-11" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
Vuex中的state用parse接收storage中的数据，parse不能对空操作，提前判断一下。</p>
<blockquote>
<p>原本在JSON.parse中，可以用<code>||</code>承接本地数据（前）和默认值（后），但偶尔会报错，得出的结论就是parse操作的数据非JSON格式。</p>
</blockquote>
</li>
<li><p><input checked disabled type="checkbox"> 
getUserInfo和getUserProfile都不能获取用户昵称和头像了。</p>
<blockquote>
<p>首先头像和昵称都给个默认值，接着点击该区域跳转到另一个页面，用&lt;头像昵称填写&gt;，修改头像昵称。</p>
<p>需要注意的是，无论是使用微信头像还是自选、照相，都只是临时地址。</p>
<p>我把它存到本地，存入成功，则&lt;个人中心&gt;的头像渲染为修改后（这里没考虑临时地址的失效，目前功能正常。可能要下载图片）。</p>
<p>存入不成功的情况（或未存）就是：用户进入修改页面但没有操作，给该页面头像和昵称分贝指定渲染的data为临时temp变量，对应temp有值时再调用mutations方法。解决用户未操作但返回上级页面时清空数据。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">tempAvatar</span> ? <span class="variable language_">this</span>.<span class="title function_">setAvatar</span>(<span class="variable language_">this</span>.<span class="property">tempAvatar</span>) : <span class="number">0</span></span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h6 id="Friday-10"><a href="#Friday-10" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
一键登录</p>
<p>微信原生的登录login是没有授权弹框的，借助getphonenumber的授权弹框获取手机号（作账号），同时调用login获取openid（作密码），用于向开发服务器请求登录（注册）。（是这么想的，没确定）</p>
</li>
</ul>
<h4 id="第十四周（2-x2F-20-2-x2F-24）"><a href="#第十四周（2-x2F-20-2-x2F-24）" class="headerlink" title="第十四周（2&#x2F;20 - 2&#x2F;24）"></a>第十四周（2&#x2F;20 - 2&#x2F;24）</h4><h6 id="Monday-12"><a href="#Monday-12" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 购物车的增、删、改、查接口（部分。数据以后端为准，避免实际数据和展示数据不一样）。</li>
<li><input checked disabled type="checkbox"> 个人信息（头像昵称）的查改接口。</li>
</ul>
<h6 id="Tuesday-12"><a href="#Tuesday-12" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
似乎数据库被攻击，导致后端接口调用失败。</p>
<p>封装收货地址的CRUD接口、搜索框的热搜记录接口、分类接口。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
之前是用mixins在相应页面中调用接口，重新整合了一下，分模块封装在utils&#x2F;api目录下。</p>
</li>
</ul>
<h6 id="Wednesday-10"><a href="#Wednesday-10" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 在PC后端管理端配置了一下热搜数据、分类数据，小程序能正常请求到了。</li>
<li><input checked disabled type="checkbox"> 接口来源商家端、平台端、小程序端，现在我主要调的是小程序端的api，但有时也要去用到其他两端的api，比如上一点的数据配置和得到我希望用到的字段。复杂的地方还是在于数据的层级和映射关系，和后端沟通了一下就明白了。</li>
</ul>
<h6 id="Thursday-12"><a href="#Thursday-12" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><input checked disabled type="checkbox"> 购物车要考虑多店铺、多sku，也就说一个店铺有多个商品，同时有多店铺的情况，现在是默认店铺唯一（初版由自身商铺上货），基本上没问题了。</li>
</ul>
<h6 id="Friday-11"><a href="#Friday-11" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><input checked disabled type="checkbox"> 之前说的token过期登录失效，就是前端每次请求都会携带token给后端校验，校验不通过返回一个表示未授权的状态码，前端判断这个状态码，清除本地token，弹出重新登录提示框。</li>
<li><input checked disabled type="checkbox"> 收货地址接口。</li>
<li><input checked disabled type="checkbox"> 用jQuery写了段网页的自动关注代码，这是第一次在浏览器控制台上直接操作，有些新奇。</li>
</ul>
<h4 id="第十五周（2-x2F-27-3-x2F-3）"><a href="#第十五周（2-x2F-27-3-x2F-3）" class="headerlink" title="第十五周（2&#x2F;27 - 3&#x2F;3）"></a>第十五周（2&#x2F;27 - 3&#x2F;3）</h4><h6 id="Monday-13"><a href="#Monday-13" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
和后端拉了个会。</p>
<p>首页有一小区域是商品，原本以为既然是商品，那就调用sku的接口就好了，但后端只有通过spuId去获得sku的接口。</p>
<p>可是一个spu会对应多个sku，那我进入商品详情页时渲染哪一个sku的数据呢？现在的做法就是这一块区域设置一个spuId对应一个skuId，有后台管理可以设置。首页的商品key绑定spuId，对应商品详情用spuId请求sku信息。</p>
</li>
</ul>
<h6 id="Tuesday-13"><a href="#Tuesday-13" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
做后端数据接入前端的处理。</p>
<p>比如说购物车的数据我们从后端拿，那么渲染结构不能直接设置为获取的数据，否则会出现购物车商品删不掉、勾选异常等问题。</p>
<p>前端用的是Vuex或本地的数据，那么此时这两者的数据就要更新为获取的后端数据，之后的crud不仅是请求上的，同时要注意本地数据的同步。</p>
</li>
</ul>
<h6 id="Wednesday-11"><a href="#Wednesday-11" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
分类接口，首先是获取一级分类categoryId，点击该菜单时请求指定分类（携参一级categoryId），得到二级菜单数据，然后可以渲染和遍历二级、三级分类。</p>
<p>对于三级分类而言，点击进入商品详情。之前都是通过spuId请求商品信息，有一个搜索接口，可以分别通过categoryId等一系列参数请求商品信息。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
之后要解决一下Git分支合并、变基的冲突问题，调整规范。</p>
<p>比方说我的A分支和另一个人的B分支都在同时编写，但现在B分支的一些功能要用到我A分支新提供的功能或API，就要变基rebase到我的分支上（在我的A分支的代码基础上开发，但还是在它的B分支上操作，同时提交或合并B分支的代码）。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
购物车修改数量的请求并不是直接赋值给后端字段的，数字加减框&lt;变化后的值&gt; - &lt;当前的值&gt; 的数值为正，则给后端字段加&lt;差值&gt;。减类推。</p>
<p>同时请求成功后，也要用差值给本地的count字段更新。这样确保购物车的商品&lt;当前的值&gt;不总是为1，下次请求不会出现前后端数据不对的情况。</p>
</li>
</ul>
<h6 id="Thursday-13"><a href="#Thursday-13" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
记录一个Bug。</p>
<blockquote>
<p>&lt;分类进入的商品详情页&gt;和&lt;商品卡片进入的商品详情页&gt;，通过不同接口获得商品数据对象cate3Goods和detailGoods，需要传递给子组件渲染。</p>
<p>一开始能正常使用，过了会就渲染不出来了，以下两种方式都只能传递第一个数据对象detailGoods给子组件：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	首先对象不能调用length属性，typeof &#123;&#125;.length的值为&quot;undefined&quot;</span></span><br><span class="line"><span class="comment">	undefined类型和number类型比较时，会将undefined转换为NaN和number数值比较</span></span><br><span class="line"><span class="comment">	所以全不等返回true，总是传递第一个数据对象</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">card-description</span> <span class="attr">:goods</span>=<span class="string">&quot;detailGoods.length!==0 ? detailGoods : cate3Goods&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">card-description</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 原因：对象转布尔值，无论有无属性，都是true --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">card-description</span> <span class="attr">:goods</span>=<span class="string">&quot;detailGoods || cate3Goods&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">card-description</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其实也不是Bug，还是Js的基础不扎实。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 解决 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">card-description</span> <span class="attr">:goods</span>=<span class="string">&quot;Object.keys(detailGoods).length!==0 ? detailGoods : cate3Goods&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">card-description</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<h6 id="Friday-12"><a href="#Friday-12" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
订单的流程，初步走了一下，有创建订单、提交订单接口。</p>
<p>可以确定的是提交订单的同时也要走支付，然后通过查询接口判断该订单有无支付</p>
<p>但是创建订单是从购物车进入结算页时就发起，还是在结算页时一并创建订单、提交订单？</p>
<p>之所以怀疑前者，是因为看淘宝从结算页返回购物车时，订单并不会多出一笔。</p>
</li>
</ul>
<p>	</p>
<h4 id="第十六周（3-x2F-6-3-x2F-10）"><a href="#第十六周（3-x2F-6-3-x2F-10）" class="headerlink" title="第十六周（3&#x2F;6 - 3&#x2F;10）"></a>第十六周（3&#x2F;6 - 3&#x2F;10）</h4><h6 id="Monday-14"><a href="#Monday-14" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><input checked disabled type="checkbox"> 准备用uniapp提供的unipay插件去做支付，不仅有微信小程序的，其他方式的支付都有。这个插件使用的是相当于后端功能的云函数，也包括云数据库等，直接开箱用（可以用免费版）。把实例项目跑通。</li>
</ul>
<h6 id="Tuesday-14"><a href="#Tuesday-14" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
把插件接入到项目里，就是报配置信息的错。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
后端出大问题了，接口调用响应速度不稳定，20s才获得数据，还不一定成功。</p>
<p>我调用一个接口三四次才成功，但层级一多，最后的调试结果还不一定是我希望的，又得重来。</p>
</li>
</ul>
<h6 id="Wednesday-12"><a href="#Wednesday-12" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><input checked disabled type="checkbox"> 搞不明白这个unipay的配置，既然后端说支付的接口已经准备好了，就直接用后端的吧。后端希望我用这个插件，是因为如果将来希望引入另一种支付方式，他就不用再写一套了。</li>
<li><input checked disabled type="checkbox"> 后端现在在解决接口的问题。微信支付我暂时没有办法去调试接入。</li>
<li><input checked disabled type="checkbox"> 收货地址有一个“我点击switch开关设置默认地址时，屏幕闪烁”的问题，但我一看拉取我代码的同学的分支，他电脑上正常运行、没有异常。不明所以的问题，等到本地图片等资源传到云端，可以真机调试时，就可以确定是不是代码的问题了。</li>
</ul>
<h6 id="Thursday-14"><a href="#Thursday-14" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><input checked disabled type="checkbox"> 我把本地的图片都干掉后去真机调试，之前微信开发工具上出现的闪屏问题就消失了。用真机调试好些，不然找Bug半天，居然又不是问题。</li>
</ul>
<h6 id="Friday-13"><a href="#Friday-13" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
因为第一版预备要上的商品只有17个，似乎不算多，所以被提了个需求，商品列表无限循环（类似轮播图）。</p>
</li>
<li><p><input disabled type="checkbox"> 
引入外部字体，调用loadFontFace成功加载，标签也引用了但是界面上就是没有效果。</p>
</li>
<li><p><input checked disabled type="checkbox"> 
在小程序项目的目录下有一个unpackage目录，他似乎是将我们编写的代码进行了编译，给微信开发者工具使用。对于Git中的冲突，真正我们编写的代码引起的冲突就一两个文件，大多都是unpackage导致的冲突。</p>
<p>unpackage应该可由我们的代码来生成，而如果在Git中忽略掉它，可能这个冲突问题好解决很多。</p>
</li>
</ul>
<h4 id="第十七周（3-x2F-13-3-x2F-17）"><a href="#第十七周（3-x2F-13-3-x2F-17）" class="headerlink" title="第十七周（3&#x2F;13 - 3&#x2F;17）"></a>第十七周（3&#x2F;13 - 3&#x2F;17）</h4><h6 id="Monday-15"><a href="#Monday-15" class="headerlink" title="Monday"></a><em>Monday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
解决上周说的unpackage目录导致的分支大量冲突问题。</p>
<blockquote>
<p>在本地.gitignore文件中添加&#x2F;unpackage，提交时忽略这个目录。</p>
<p>但此时远程仓库中已经有unpackage目录了，删除远程仓库对应分支的unpackage目录：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// -r 表示递归删除目录下的所有文件、目录</span></span><br><span class="line"><span class="comment">// --cached 表示移除跟踪名单，但保留本地</span></span><br><span class="line">git rm -r <span class="attr">--cached</span> unpackage</span><br></pre></td></tr></table></figure>

<p>再add、commit、push。最后把我的分支提交到master分支时冲突只有两三个文件了。</p>
</blockquote>
<p>我是通过命令行去合并的，首先切换到master分支，再去merge我需要合并的Cookie分支。此时我本地只有一个Cookie分支：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// （√）拉取远程仓库主分支到本地新建master分支</span></span><br><span class="line">git checkout -<span class="selector-tag">b</span> master origin/master</span><br><span class="line"></span><br><span class="line"><span class="comment">// （×）之前一直尝试用以下方法去拉取master分支代码</span></span><br><span class="line"><span class="comment">// 但切换后的新建分支，其实还是和我的Cookie分支代码一样，此时pull只是更新了对应文件的代码</span></span><br><span class="line"><span class="comment">// 并不是我想要的master分支</span></span><br><span class="line">git checkout -<span class="selector-tag">b</span> master</span><br><span class="line">git pull origin master</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解决冲突后要重新add、commit，才能继续合并</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="Tuesday-15"><a href="#Tuesday-15" class="headerlink" title="Tuesday"></a><em>Tuesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
分包与预加载。</p>
<p>创建多个分包，同时在pages.json文件下与subPackages同级别的preloadRule中配置预加载。比如：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 作用是当切换到shop页面时，就提前加载下一级页面资源，而不是点击进入时才下载。</span></span><br><span class="line">&quot;preloadRule&quot;: &#123;</span><br><span class="line">    &quot;pages/shop/shop&quot;:&#123;</span><br><span class="line">        &quot;network&quot;: <span class="string">&quot;all&quot;</span>,</span><br><span class="line">        <span class="string">&quot;packages&quot;</span>:[<span class="string">&quot;subpkg_goods&quot;</span>]	// 分包的root属性</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><input checked disabled type="checkbox"> 
除预加载外，解决页面抖动还有一方面：样式设置的数据是通过页面onLoad获取的数据，不应该采取这种方式，数据的获取、更新有一段时间间隔。</p>
</li>
</ul>
<h6 id="Wednesday-13"><a href="#Wednesday-13" class="headerlink" title="Wednesday"></a><em>Wednesday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
收货地址。</p>
<blockquote>
<p>&lt;添加收货地址&gt;接口是不需要addrId参数的，此后的&lt;更新&gt;、&lt;删除&gt;需要这个参数。</p>
<p>问题在于本地添加地址后，现在在&lt;地址列表&gt;页面的每一项是以index作为key绑定值，点击对应项如何请求更新后端对应地址？</p>
<p>调用&lt;获取地址列表&gt;接口时做两个判断：</p>
<ol>
<li><p>本地没有地址时</p>
<p>此时就使用接口获取的数据存储到本地。</p>
</li>
<li><p>本地有地址时</p>
<p>外层循环对本地userAddress遍历，内层循环对&lt;获取地址列表&gt;请求的数据res遍历。</p>
<p>将本地userAddress的收货人、电话、详细地址等都转为一串字符串localStr，res同理创建resStr。两者相等时，把res的遍历对象的addrId赋值到本地userAddress的对象上。</p>
</li>
</ol>
<p>&lt;获取地址列表&gt;接口调用位置：</p>
<p>除了&lt;地址列表&gt;页面onLoad时调用&lt;获取收货地址&gt;接口外，&lt;添加收货地址&gt;与&lt;修改收货地址&gt;navigateBack返回上一层页面的同时，也调用&lt;获取收货地址&gt;接口。</p>
<p>&lt;地址列表&gt;页面的key就用addrId绑定。</p>
</blockquote>
<h6 id="Thursday-15"><a href="#Thursday-15" class="headerlink" title="Thursday"></a><em>Thursday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
处理加购逻辑。</p>
<p>如果购物车中已经有当前&lt;商品详情页&gt;中的商品了，那么再点击加购，应该是增加对应购物车商品的数量。</p>
<p>和昨天说的收货地址列表需要addrId一样，购物车列表需要cartItemId做添加、删除、修改请求。同样的方法，在请求&lt;购物车列表&gt;接口时把商品数据添加进本地。</p>
<p>请求&lt;购物车列表&gt;接口的地方：判断购物车中该商品不存在，&lt;商品详情页&gt;点击加购、请求加购接口成功后；</p>
<p>如果判断购物车该商品存在，则调用修改数量接口，同时修改本地对应商品的数量（既然已存在，就说明之前已请求&lt;购物车列表&gt;添加到本地，有cartItemId。通过cartItemId可以找到本地的商品）。</p>
</li>
</ul>
<h6 id="Friday-14"><a href="#Friday-14" class="headerlink" title="Friday"></a><em>Friday</em></h6><ul>
<li><p><input checked disabled type="checkbox"> 
页面抖动的解决还有一方面：view没有设置高度，是根据内容高度来设置自身高度的。所以获取到数据前后高度不一样，会发生抖动。</p>
<p>顺便做了骨架屏，获取到数据前用css效果等待，而不是白屏。（之前有一期&lt;Web 50Projects 4&gt;刚好是这个）</p>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>实习</category>
      </categories>
      <tags>
        <tag>周记</tag>
      </tags>
  </entry>
</search>
